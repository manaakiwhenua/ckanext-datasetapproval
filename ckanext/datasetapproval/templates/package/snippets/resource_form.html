{% ckan_extends %}

{% block basic_fields %}
	{% if stage %}
		{% if stage != 1 %}
			{% if 'complete' in stage %} {# When new resource added on newly created dataset. #}
				<input id="field-pkg_publishing_status" type="hidden" name="pkg_publishing_status" value="in_review" />
			{% endif %}
		{% else %}  {# When existing resource is edited. #}
			<input id="field-pkg_publishing_status" type="hidden" name="pkg_publishing_status" value="draft" />
		{% endif %}
	{% else %} {# When new resource is added #}
		<input id="field-pkg_publishing_status" type="hidden" name="pkg_publishing_status" value="draft" />
	{% endif %}
{% endblock %}

{% block stages %}
  {% if not h.is_admin(c.user) %}
    {% snippet "package/snippets/dataset_approval_alert_note.html" %}
  {% endif %}
  {% if form_style != 'edit' %}
    {{ super() }}
  {% endif %}
{% endblock %}

{% block delete_button %}
{% if data.id %}
  {% if h.check_access('resource_delete', {'id': data.id})  %}
    <a class="btn btn-danger pull-left" href="{% url_for dataset_type ~ '_resource.delete', resource_id=data.id, id=pkg_name %}" data-module="confirm-action" data-module-content="{{ _('Are you sure you want to delete this resource?') }}">{% block delete_button_text %}{{ _('Delete') }}{% endblock %}</a>
  {% endif %}
{% endif %}
{% endblock %}
{% if stage %}
{% block previous_button %}
  <button class="btn btn-default" name="save" value="go-dataset" type="submit">{{ _('Previous') }}</button>
{% endblock %}
{% endif %}
{% block again_button %}
<button class="btn btn-default" name="save" value="again" type="submit">{{ _('Save & add another') }}</button>
{% endblock %}  
{% if stage %}
   {% block save_button %}
{% if stage != 1 %}
  {% if 'complete' in stage %}
    <button class="btn btn-warning" name="save" type="submit"  data-module="form-save" data-module="form-save" data-module-type="resource-draft">{{ _('Finish & save as draft') }}</button>
  {% endif %}
{% endif %}
  <button class="btn btn-primary" name="save" value="go-metadata" type="submit">{% block save_button_text %}{{_('Finish')}}{% endblock %}</button>
{% endblock %}
{% else %}
{% block add_button %}
  <button class="btn btn-primary" name="save" value="go-dataset-complete" type="submit">{{ _('Add') }}</button>
{% endblock %}
{% endif %}